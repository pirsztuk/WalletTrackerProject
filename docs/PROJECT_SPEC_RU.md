# Проект: Wallet Tracker

## 1. Общая цель  
Построить **универсальную систему учёта счетов и расходов** с двумя интерфейсами:  
- **Telegram-бот** как быстрый и удобный UI для ведения операций “на ходу”  
- **REST API** для интеграции со сторонними сервисами и собственными скриптами  

Система должна быть полностью контейнеризирована (Docker & Docker Compose), легко масштабироваться и развёртываться «одной командой».

---

## 2. Основные задачи

1. **Учёт счетов и трат**  
   - Пользователь создаёт несколько «кошельков» (отдельные счёта)  
   - Добавляет расходы и доходы с произвольными метками и категориями  
   - Просматривает баланс и историю операций  

2. **Telegram-бот как основной UI**  
   - Команды для быстрого создания кошелька, добавления операции, просмотра баланса  
   - При каждом запросе бот генерирует **одноразовый JWT** с коротким lifetime (10 сек), чтобы backend мог убедиться в легитимности вызова  
   - Вся логика аутентификации бота → API построена на этом механизме  

3. **Открытое REST API для пользователя**  
   - Пользователь через бота создаёт себе **долговечный Personal Token** (например, срок действия 1–5 лет)  
   - По этому токену он может выгружать свои данные вне Telegram (например, на домашний сервер, BI-систему или в собственное приложение)  
   - API поддерживает стандартные операции чтения: список кошельков, транзакций, сводные отчёты  

---

## 3. Архитектура и безопасность

- **Docker Compose**: сервисы
  - `db` (PostgreSQL)
  - `web` (Django + DRF)
  - `bot` (Telegram-бот)
- **JWT-аутентификация**:
  1. **Short-Lived Bot Token**  
     - Генерируется ботом при каждом запросе к API  
     - HS256/RS256, lifetime = 10 сек  
     - Защищает от подмены и повторного использования  
  2. **Long-Lived User Token**  
     - Создаётся внутри бота командой `/token create`  
     - Срок действия — configurable (по умолчанию 1 год)  
     - Используется для любых сторонних HTTP-клиентов  

---

## 4. Ключевые требования


- **Докеризация**: проект запускается одной командой `docker-compose up --build`  
- **DRF + SimpleJWT**:  
  - Конфигурация двух схем JWT с разными настройками lifetime  
  - Middleware, проверяющий короткоживущий токен для запросов от бота  
- **Telegram-бот**:  
  - Лёгкий CLI-интерфейс (aiogram или python-telegram-bot)  
  - Минимальный набор команд для CRUD-операций  
- **Документация**:  
  - `README.md` с кратким описанием и примерами использования бота и API  
  - Автогенерация Swagger/OpenAPI (DRF Spectacular или drf-yasg)  

---

## 5. Критерии готовности к сдаче

- Успешно собранный стек в Docker (web, db, bot)  
- Корректная работа JWT-схем (10 сек для бота, долгий для пользователя)  
- Telegram-бот выполняет операции и получает ответы от API  
- Пользовательский токен выдаёт доступ к API вне Telegram  
- Наличие автоматизированных тестов для основных сценариев  
- Документация и примеры для разработчика  

---

## 6. Опциональные улучшения

- Реализовать **Rate-Limit** для защиты API  
- Подключить **Celery + Redis** для фоновых задач (например, бэкапы или уведомления о превышении бюджета)  
- Веб-панель на React/Vue для визуализации балансов и графиков расходов  
- Webhook-уведомления в Telegram при достижении пороговых значений

---

> **Результат**: автономное решение «Wallet Tracker» с гибкой аутентификацией, удобным бот-интерфейсом и открытым API для глубоких интеграций. 