# Project: Wallet Tracker

## 1. Overall Goal  
Build a **universal wallet and expense management system** with two interfaces:  
- **Telegram Bot** as a fast, convenient UI for on-the-go transactions  
- **REST API** for integration with third-party services and custom scripts  

The solution must be fully containerized (Docker & Docker Compose), easily scalable, and deployable with a single command.

---

## 2. Core Requirements

1. **Wallet & Expense Management**  
   - Users create multiple “wallets” (separate accounts)  
   - Record expenses and income with arbitrary tags and categories  
   - View current balances and transaction history  

2. **Telegram Bot as Primary UI**  
   - Commands for quick wallet creation, transaction entry, and balance checks  
   - On each request, the bot generates a **single-use JWT** (10-second lifetime) to validate calls on the backend  
   - All bot-to-API authentication is based on this mechanism  

3. **Open REST API for End Users**  
   - Via the bot, users generate a **long-lived Personal Token** (configurable, e.g. 1–5 years)  
   - This token allows external clients (home servers, BI tools, custom apps) to fetch user data  
   - API supports standard read operations: list wallets, list transactions, summary reports  

---

## 3. Architecture & Security

- **Docker Compose** services:  
  - `db` (PostgreSQL)  
  - `web` (Django + DRF)  
  - `bot` (Telegram Bot)  

- **JWT Authentication**:  
  1. **Short-Lived Bot Token**  
     - Generated by the bot for each API call  
     - HS256/RS256, lifetime = 10 seconds  
     - Prevents replay and unauthorized use  
  2. **Long-Lived User Token**  
     - Created via bot command (`/token create`)  
     - Lifetime configurable (default 1 year)  
     - Used by any external HTTP client  

---

## 4. Key Requirements

- **Containerization**: launch all services with `docker-compose up --build`  
- **DRF + SimpleJWT**:  
  - Two JWT schemes with separate lifetimes  
  - Middleware enforcing short-lived tokens for bot requests  
- **Telegram Bot**:  
  - Lightweight CLI interface (aiogram or python-telegram-bot)  
  - Minimal command set for CRUD operations  
- **Documentation**:  
  - `README.md` with setup instructions and usage examples  
  - Auto-generated OpenAPI/Swagger (e.g., DRF Spectacular or drf-yasg)  

---

## 5. Acceptance Criteria

- Fully built Docker stack (`web`, `db`, `bot`)  
- Correct JWT behavior (10-s bot tokens, long-lived user tokens)  
- Telegram bot performs operations via the API successfully  
- Personal tokens grant external API access  
- Automated tests covering core workflows  
- Comprehensive developer documentation and examples  

---

## 6. Optional Enhancements

- Implement **rate limiting** to protect the API  
- Integrate **Celery + Redis** for background tasks (backups, budget alerts)  
- Add a web dashboard (React or Vue) for visualizing balances and expense charts  
- Enable Telegram webhooks for threshold-based notifications  

---

> **Outcome**: A standalone “Wallet Tracker” solution featuring flexible authentication, an intuitive bot interface, and an open API for seamless integrations.